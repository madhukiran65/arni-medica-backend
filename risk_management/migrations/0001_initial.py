# Generated by Django 5.2.11 on 2026-02-26 21:33

import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('change_controls', '0003_changecontrol_all_child_tasks_complete_and_more'),
        ('complaints', '0002_complaint_affected_lot_numbers_and_more'),
        ('deviations', '0003_deviation_linked_equipment_deviation_risk_occurrence_and_more'),
        ('documents', '0005_document_requires_dual_approval_and_more'),
        ('users', '0004_role_field_level_permissions_and_more'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='FMEAWorksheet',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(default=True)),
                ('fmea_id', models.CharField(editable=False, max_length=50, unique=True)),
                ('title', models.CharField(max_length=255)),
                ('description', models.TextField(blank=True, null=True)),
                ('fmea_type', models.CharField(choices=[('design', 'Design FMEA'), ('process', 'Process FMEA'), ('use', 'Use FMEA')], max_length=50)),
                ('status', models.CharField(choices=[('draft', 'Draft'), ('in_review', 'In Review'), ('approved', 'Approved'), ('superseded', 'Superseded')], default='draft', max_length=50)),
                ('approval_date', models.DateTimeField(blank=True, null=True)),
                ('approved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='approved_fmea_worksheets', to=settings.AUTH_USER_MODEL)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('product_line', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='fmea_worksheets', to='users.productline')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(app_label)s_%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'FMEA Worksheet',
                'verbose_name_plural': 'FMEA Worksheets',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='FMEARecord',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(default=True)),
                ('item_function', models.CharField(max_length=255)),
                ('failure_mode', models.CharField(max_length=255)),
                ('failure_effect', models.TextField()),
                ('failure_cause', models.TextField()),
                ('current_controls_prevention', models.TextField(blank=True, null=True)),
                ('current_controls_detection', models.TextField(blank=True, null=True)),
                ('severity', models.IntegerField()),
                ('occurrence', models.IntegerField()),
                ('detection', models.IntegerField()),
                ('recommended_action', models.TextField(blank=True, null=True)),
                ('action_taken', models.TextField(blank=True, null=True)),
                ('new_severity', models.IntegerField(blank=True, null=True)),
                ('new_occurrence', models.IntegerField(blank=True, null=True)),
                ('new_detection', models.IntegerField(blank=True, null=True)),
                ('target_date', models.DateField(blank=True, null=True)),
                ('completion_date', models.DateField(blank=True, null=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('responsible_person', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='fmea_records', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(app_label)s_%(class)s_updated', to=settings.AUTH_USER_MODEL)),
                ('worksheet', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='records', to='risk_management.fmeaworksheet')),
            ],
            options={
                'verbose_name': 'FMEA Record',
                'verbose_name_plural': 'FMEA Records',
                'ordering': ['worksheet', 'created_at'],
            },
        ),
        migrations.CreateModel(
            name='Hazard',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(default=True)),
                ('hazard_id', models.CharField(editable=False, max_length=50, unique=True)),
                ('name', models.CharField(max_length=255)),
                ('description', models.TextField(blank=True, null=True)),
                ('source', models.CharField(choices=[('design', 'Design'), ('manufacturing', 'Manufacturing'), ('use', 'Use'), ('environmental', 'Environmental'), ('software', 'Software')], max_length=50)),
                ('harm_description', models.TextField()),
                ('affected_population', models.CharField(blank=True, max_length=500, null=True)),
                ('severity_of_harm', models.CharField(blank=True, max_length=255, null=True)),
                ('status', models.CharField(choices=[('identified', 'Identified'), ('assessed', 'Assessed'), ('mitigated', 'Mitigated'), ('accepted', 'Accepted'), ('monitored', 'Monitored')], default='identified', max_length=50)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('department', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='hazards', to='users.department')),
                ('linked_complaint', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='hazards', to='complaints.complaint')),
                ('linked_deviation', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='hazards', to='deviations.deviation')),
                ('product_line', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='hazards', to='users.productline')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(app_label)s_%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Hazard',
                'verbose_name_plural': 'Hazards',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='RiskAssessment',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(default=True)),
                ('assessment_type', models.CharField(choices=[('initial', 'Initial'), ('residual', 'Residual'), ('post_market', 'Post-Market')], max_length=50)),
                ('severity', models.IntegerField()),
                ('occurrence', models.IntegerField()),
                ('detection', models.IntegerField()),
                ('acceptability', models.CharField(choices=[('acceptable', 'Acceptable'), ('alara', 'ALARA'), ('unacceptable', 'Unacceptable'), ('conditional', 'Conditional')], max_length=50)),
                ('justification', models.TextField(blank=True, null=True)),
                ('assessment_date', models.DateTimeField(auto_now_add=True)),
                ('assessed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='risk_assessments', to=settings.AUTH_USER_MODEL)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('hazard', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='risk_assessments', to='risk_management.hazard')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(app_label)s_%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Risk Assessment',
                'verbose_name_plural': 'Risk Assessments',
                'ordering': ['-assessment_date'],
            },
        ),
        migrations.CreateModel(
            name='RiskCategory',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('name', models.CharField(max_length=255, unique=True)),
                ('description', models.TextField(blank=True, null=True)),
                ('is_active', models.BooleanField(default=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(app_label)s_%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Risk Category',
                'verbose_name_plural': 'Risk Categories',
                'ordering': ['name'],
            },
        ),
        migrations.AddField(
            model_name='hazard',
            name='category',
            field=models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='hazards', to='risk_management.riskcategory'),
        ),
        migrations.CreateModel(
            name='RiskMitigation',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(default=True)),
                ('mitigation_type', models.CharField(choices=[('design_change', 'Design Change'), ('process_control', 'Process Control'), ('labeling_warning', 'Labeling/Warning'), ('training', 'Training'), ('protective_measure', 'Protective Measure')], max_length=50)),
                ('description', models.TextField()),
                ('implementation_status', models.CharField(choices=[('planned', 'Planned'), ('in_progress', 'In Progress'), ('implemented', 'Implemented'), ('verified', 'Verified')], default='planned', max_length=50)),
                ('verification_method', models.TextField(blank=True, null=True)),
                ('verification_result', models.TextField(blank=True, null=True)),
                ('target_date', models.DateField(blank=True, null=True)),
                ('completion_date', models.DateField(blank=True, null=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('hazard', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='mitigations', to='risk_management.hazard')),
                ('linked_change_control', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='risk_mitigations', to='change_controls.changecontrol')),
                ('linked_document', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='risk_mitigations', to='documents.document')),
                ('responsible_person', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='risk_mitigations', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(app_label)s_%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Risk Mitigation',
                'verbose_name_plural': 'Risk Mitigations',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='RiskMonitoringAlert',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(default=True)),
                ('alert_type', models.CharField(choices=[('threshold_breach', 'Threshold Breach'), ('trend_detected', 'Trend Detected'), ('new_complaint', 'New Complaint'), ('occurrence_exceeded', 'Occurrence Exceeded')], max_length=50)),
                ('message', models.TextField()),
                ('threshold_value', models.CharField(blank=True, max_length=255, null=True)),
                ('actual_value', models.CharField(blank=True, max_length=255, null=True)),
                ('is_acknowledged', models.BooleanField(default=False)),
                ('acknowledged_at', models.DateTimeField(blank=True, null=True)),
                ('acknowledged_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='acknowledged_risk_alerts', to=settings.AUTH_USER_MODEL)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('hazard', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='monitoring_alerts', to='risk_management.hazard')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(app_label)s_%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Risk Monitoring Alert',
                'verbose_name_plural': 'Risk Monitoring Alerts',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='RiskReport',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(default=True)),
                ('report_id', models.CharField(editable=False, max_length=50, unique=True)),
                ('title', models.CharField(max_length=255)),
                ('report_type', models.CharField(choices=[('initial_risk_analysis', 'Initial Risk Analysis'), ('risk_management_report', 'Risk Management Report'), ('post_market_update', 'Post-Market Update'), ('benefit_risk_analysis', 'Benefit-Risk Analysis')], max_length=100)),
                ('description', models.TextField(blank=True, null=True)),
                ('overall_risk_acceptability', models.CharField(choices=[('acceptable', 'Acceptable'), ('not_acceptable', 'Not Acceptable'), ('conditionally_acceptable', 'Conditionally Acceptable')], max_length=50)),
                ('benefit_risk_conclusion', models.TextField(blank=True, null=True)),
                ('status', models.CharField(choices=[('draft', 'Draft'), ('in_review', 'In Review'), ('approved', 'Approved')], default='draft', max_length=50)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('linked_document', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='risk_reports', to='documents.document')),
                ('product_line', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='risk_reports', to='users.productline')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='%(app_label)s_%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Risk Report',
                'verbose_name_plural': 'Risk Reports',
                'ordering': ['-created_at'],
            },
        ),
        migrations.AddIndex(
            model_name='fmeaworksheet',
            index=models.Index(fields=['fmea_id'], name='risk_manage_fmea_id_740cef_idx'),
        ),
        migrations.AddIndex(
            model_name='fmeaworksheet',
            index=models.Index(fields=['status'], name='risk_manage_status_c47dec_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='riskassessment',
            unique_together={('hazard', 'assessment_type')},
        ),
        migrations.AddIndex(
            model_name='hazard',
            index=models.Index(fields=['hazard_id'], name='risk_manage_hazard__b210d2_idx'),
        ),
        migrations.AddIndex(
            model_name='hazard',
            index=models.Index(fields=['status'], name='risk_manage_status_0b7ad2_idx'),
        ),
        migrations.AddIndex(
            model_name='hazard',
            index=models.Index(fields=['source'], name='risk_manage_source_e09f94_idx'),
        ),
        migrations.AddIndex(
            model_name='riskmitigation',
            index=models.Index(fields=['implementation_status'], name='risk_manage_impleme_6b3ac9_idx'),
        ),
        migrations.AddIndex(
            model_name='riskmonitoringalert',
            index=models.Index(fields=['is_acknowledged'], name='risk_manage_is_ackn_000154_idx'),
        ),
        migrations.AddIndex(
            model_name='riskmonitoringalert',
            index=models.Index(fields=['alert_type'], name='risk_manage_alert_t_f117d0_idx'),
        ),
        migrations.AddIndex(
            model_name='riskreport',
            index=models.Index(fields=['report_id'], name='risk_manage_report__851fa9_idx'),
        ),
        migrations.AddIndex(
            model_name='riskreport',
            index=models.Index(fields=['status'], name='risk_manage_status_ee4eae_idx'),
        ),
    ]
